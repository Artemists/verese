<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<!-- Login and basic info page -->

<head>
  <meta name="generator" content="HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">

  <title>verese</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.css" type="text/css">
  <script src="http://code.jquery.com/jquery-1.6.2.min.js" type="text/javascript"></script>
  <script src="http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.js" type="text/javascript"></script>
  <script src="https://browserid.org/include.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/media/main.css" type="text/css">
  <link rel="apple-touch-icon-precomposed" href="/media/images/touch-icon.png"/>

</head>

<body>
  <!-- Login Page -->

  <div data-role="page" id="login" style="text-align:center;">
    <div data-role="header" data-position="fixed">
      <h1>verese</h1>
    </div><!-- /header -->

    <div data-role="content">
      <p>Verese - Owe me now!</p>

      <div data-role="fieldcontain">
        <form id="loginform" method="post" action="/api/v1.0/login/">
          {% csrf_token %}
	  <label for="username">Username:</label>
	  <input type="text" name="username" id="username" value="">
	  <label for="password">Password:</label>
	  <input type="password" name="password" id="password" value="">
	  <button value="submit-value" name="submit" data-theme="a" type="submit" class="ui-btn-hidden" aria-disabled="false">Login</button>
	  <input type="hidden" name="next" value="/verese/"/>

        </form>

	<a id="browserid" href="#"><img src="https://browserid.org/i/sign_in_blue.png"></img></a>
	<form method="POST" action="{% url browserid_verify %}" data-ajax="false">
	{% csrf_token %}
	<input type="hidden" name="assertion" id="id_assertion" />
	</form>

      </div>

      <a href="#faq" data-role="button" data-transition="slide" data-inline="true" data-icon="info">Frequently Asked Questions</a>
    </div><!-- /content -->

    <div data-role="footer" data-theme="d">
      <h4><sub>copyleft verese project 2011</sub></h4>
    </div><!-- /footer -->

  <script>
  (function() {
  var fixgeometry = function() {
  /* Some orientation changes leave the scroll position at something
  * that isn't 0,0. This is annoying for user experience. */
  scroll(0, 0);

  /* Calculate the geometry that our content area should take */
  var header = $("div[data-role='header']:visible");
  var footer = $("div[data-role='footer']:visible");
  var content = $("div[data-role='content']:visible:visible");
  var viewport_height = $(window).height();
 
  var content_height = viewport_height - header.outerHeight() - footer.outerHeight();
  if((content.outerHeight() header.outerHeight() footer.outerHeight())<=viewport_height)
  {
  content_height -= (content.outerHeight() - content.height() 1);
content.height(content_height);
  }
  /* Trim margin/border/padding height */
  }; /* fixgeometry */

  $(document).ready(function() {
  $(window).bind("orientationchange resize pageshow", fixgeometry);
  });
  })();
  </script>

  </div><!-- /login page -->
  <!-- FAQ Page -->

  <div data-role="page" id="faq" data-add-back-btn="true">
    <div data-role="header" data-position="fixed">
      <h1>verese</h1>

      <h2>What is verese?</h2>

      <h2>How to use it?</h2>

      <h2>Is is free?</h2>
    </div><!-- /header -->

    <div data-role="footer" data-theme="d">
      <h4><sub>copyleft verese project 2011</sub></h4>
    </div><!-- /footer -->
  </div><!-- /FAQ page -->



<script>
$(document).bind('pagecreate', (function() {
  $('#loginform').submit(function(event) {
     $.mobile.showPageLoadingMsg();

     var success_cb = function(dataReceived, textStatus) {
       $.mobile.changePage("/verese/", { 'transition':'pop' });
     }

     var error_cb = function(dataReceived, textStatus, errorThrown) {
       alert('login error, try again');
       // make this a jqm popup or something
     }

     $.ajax({
        type: 'POST',
        url: '/api/v1.0/login/',
        dataType: 'text',
        data: $(this).serialize(),
        success: success_cb,
        error: error_cb
        })
  });

  // focus on username
  $('#username').focus();

  // browserid
  $('#browserid').bind('click', function(e) {
    e.preventDefault();
    navigator.id.getVerifiedEmail(function(assertion) {
        if (assertion) {
            var $e = $('#id_assertion');
            $e.val(assertion.toString());
            $e.parent().submit();
        }
    });
  });


  })
);


</script>


  </body>
</html>
